if(!customElements.get("product-selector")){class t extends HTMLElement{constructor(){super(),this.mainElement=this.closest(".highlighted-product"),this.inputWrapper="[data-input-wrapper]",this.variants=JSON.parse(this.querySelector('[type="application/json"]').textContent),this.variantOptionInputs=this.querySelectorAll(".product-option__input"),this.form=document.querySelector("#ProductForm-"+this.dataset.sectionId),this.purchaseOptions=document.querySelector("#Product-Purchase-Options-"+this.dataset.sectionId),this.productBar=document.querySelector("#ProductBar-"+this.dataset.sectionId),this.installmentsForm=document.querySelector("#Product-Installments-"+this.dataset.installmentsFormId),this.addEventListener("change",this.onVariantChange),this.addEventListener("keydown",this.onKeyDown),this.updateOptions(),this.updateVariantStatuses(),this.updateVariant(),this.updateMedia(),this.scrollToImage(),this.form?.toggleAddButton(!this.currentVariant.available,"")}updateVariantStatuses(){let t=this.querySelector(this.inputWrapper).querySelector(":checked").value,e=this.variants.filter(e=>t===e.option1),a=[...this.querySelectorAll(this.inputWrapper)];a.forEach((t,i)=>{if(0!==i){let r=a[i-1].querySelector(":checked").value,n=e.filter(t=>t.available&&t["option"+i]===r).map(t=>t["option"+(i+1)]);[...t.querySelectorAll('input[type="radio"], option')].forEach(t=>{var e,a=!n.includes(t.getAttribute("value"));t.disabled=a,"option"===t.tagName.toLowerCase()&&(e=`button[data-value="${t.value.replace(/"/g,'\\"')}"]`,e=t.closest("dropdown-input").querySelector(e))&&(e.disabled=a),this.productBar&&(e=t.dataset.id||t.id,t=this.productBar.querySelector(`option[data-id="${e}"]`))&&(t.disabled=a)})}}),this.querySelectorAll('input[type="radio"]').forEach(t=>{t.checked&&t.nextElementSibling.classList.add("is-active")}),this.updateVariantOptionsLegend()}updatePriceForVariant(t){var e,a,i,r,n=this.variants.find(e=>e.id===t);n&&(e=this.mainElement.querySelector(".price__container"))&&(i=e.dataset.moneyFormat,a=formatPrice(i,n.price/100),i=formatPrice(i,n.compare_at_price/100),n=e.dataset.labelPriceRegular,r=e.dataset.labelPriceSale,parseFloat(i)>parseFloat(a)?e.innerHTML=`\n            <div class="price__sale">\n              <div class="price__sale-inner">\n                <span class="visually-hidden">${r}</span>\n                <s>${i}</s>\n                <ins>\n                  <span class="visually-hidden">${n}</span>\n                  ${a}\n                </ins>\n              </div>\n            </div>\n          `:e.innerHTML=`\n            <div class="price__sale">\n              <div class="price__sale-inner">\n                <span class="visually-hidden">${n}</span>\n                ${a}\n              </div>\n            </div>\n          `)}updateDiscountBadgeForVariant(t){var e,a,i=this.variants.find(e=>e.id===t);i&&(e=this.mainElement.querySelector(".product-card__badge--discount"))&&(i.compare_at_price>i.price?(e.classList.remove("hidden"),a=e.querySelector(".percentage"),i=Math.round((i.compare_at_price-i.price)/i.compare_at_price*100),a.textContent=i):e.classList.add("hidden"))}onKeyDown(t){"Enter"===t.key&&(t=t.target).classList.contains("swatch")&&t.click()}onVariantChange(t){"number"!==t.target.type&&(this.updateOptions(),this.currentVariant!==this.getVariantData())&&(this.updateVariant(),this.updateVariantStatuses(),this.updatePriceForVariant(this.currentVariant.id),this.updateDiscountBadgeForVariant(this.currentVariant.id),this.productBarUpdateOptions(),this.updatePickupAvailability(),this.form.removeAttribute("data-has-selling-plan"),this.form.toggleAddButton(!1,""),this.form.handleErrorMessage(),this.currentVariant?(this.currentVariant.available||this.form.toggleAddButton(!0,window.variantStrings.soldOut),this.closest(".product").classList.contains("highlighted-product")||this.updateURL(),this.updateVariantInput(),this.renderProductInfo(),this.updateSKU(),this.updateVariantOptionsLegend(),this.updateMedia(),this.scrollToImage()):(this.form.toggleAddButton(!0,""),this.setUnavailable()))}updateOptions(){this.querySelectorAll('input[type="radio"]').forEach(t=>{t.disabled?t.nextElementSibling.classList.toggle("is-active",!1):t.nextElementSibling.classList.toggle("is-active",t.checked)}),this.options=Array.from(this.querySelectorAll('input[type="radio"]:checked, select'),t=>({name:t.dataset.name||t.name,value:t.value}))}productBarUpdateOptions(){this.productBar&&(Array.from(this.productBar.querySelectorAll("select")).map(t=>{t.value=this.options.find(e=>e.name===t.name).value}),this.productBar.querySelectorAll("dropdown-input").forEach(t=>{t.update()}))}updateInventoryNotice(t){var e=this.closest(".product").querySelector("[data-inventory-notice]");(t=t.querySelector("[data-inventory-notice]"))&&e&&(e.innerHTML=t.innerHTML)}updatePickupAvailability(){var t=document.querySelector("pickup-availability");t&&this.currentVariant&&(t.dataset.variantId=this.currentVariant.id,this.currentVariant&&this.currentVariant.available?(t.setAttribute("available",""),t.fetchAvailability(t.dataset.variantId)):(t.removeAttribute("available"),t.innerHTML=""))}updateVariant(){this.currentVariant=this.getVariantData()}getVariantData(){return this.options.length?this.variants.find(t=>!t.options.map((t,e)=>this.options[e].value===t).includes(!1)):this.variants[0]}updateMedia(){if(this.currentVariant&&this.currentVariant.featured_media){let t=this.closest(".product").querySelector("product-media");(t=t||this.closest(".main-product").querySelector("swiper-product-gallery")).setActiveMedia(this.currentVariant.featured_media.id)}}updateSKU(){document.querySelector(".product__sku")&&(document.querySelector(".product__sku span").innerText=this.currentVariant.sku||"")}updateURL(t){var e;this.currentVariant&&((e=new URLSearchParams(window.location.search))[e.has("variant")?"set":"append"]("variant",this.currentVariant.id),t?e[e.has("selling_plan")?"set":"append"]("selling_plan",t):e.delete("selling_plan"),window.history.replaceState({},"",this.dataset.url+"?"+e.toString()))}updateVariantInput(){[this.querySelector('[name="id"'),this.installmentsForm?.querySelector('[name="id"]')].forEach(t=>{t&&(t.value=this.currentVariant.id,t.dispatchEvent(new Event("change",{bubbles:!0})))})}setUnavailable(){var t=this.form.submitButton,e=this.querySelector("#Product-Price-"+this.dataset.sectionId);t&&(t.textContent=window.variantStrings.unavailable,e)&&e.classList.add("visibility-hidden")}renderProductInfo(){var t=new URLSearchParams(window.location.search);t[t.has("variant")?"set":"append"]("variant",this.currentVariant.id),this.closest(".product").classList.contains("highlighted-product")||t.append("section_id",this.dataset.sectionId),fetch(this.dataset.url+"?"+t.toString()).then(t=>t.text()).then(t=>{let e=(new DOMParser).parseFromString(t,"text/html");["#Product-Price-"+this.dataset.sectionId,"#Product-Purchase-Options-"+this.dataset.sectionId,".product__sticky-cart-wrapper"].map(t=>{var a=document.querySelector(t);t=e.querySelector(t);this.updateInventoryNotice(e),a&&t&&(a.classList.remove("visibility-hidden"),a.innerHTML=t.innerHTML)})})}updateVariantOptionsLegend(){this.variantOptionInputs.forEach(t=>{var e,a=t.closest(".js-product-variants").querySelector("legend").querySelector(".product-selector__label-text");a&&t.checked&&(t=t.nextElementSibling.title,(e=a.nextElementSibling)&&e.classList.contains("active-variant-label")?e.textContent=t:((e=document.createElement("span")).classList.add("active-variant-label"),e.textContent=t,a.insertAdjacentElement("afterend",e)))})}scrollToImage(){this.closest(".product").querySelectorAll("[data-product-images]").forEach(t=>{t.getAttribute("data-product-images").includes(this.currentVariant.id)&&t.scrollIntoView({behavior:"smooth"})})}}customElements.define("product-selector",t)}