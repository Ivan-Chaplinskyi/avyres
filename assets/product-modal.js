class ProductModal extends ModalDialog{constructor(){super(),this.sliderInstance=new Swiper(this.querySelector("[data-modal-slider]"),{slidesPerView:1,navigation:{prevEl:this.querySelector(".swiper-button--prev"),nextEl:this.querySelector(".swiper-button--next")},on:{slideChangeTransitionEnd:e=>{this.playActiveSlideVideo(e)}}})}show(e){this.openedBy=e,this.setAttribute("open",""),trapFocus(this,this.dialogHolder),window.pauseAllMedia(),e.hasAttribute("data-model-opener")?this.showActiveMedia(e.dataset.mediaId):this.showActiveMedia()}hide(){document.body.dispatchEvent(new CustomEvent("modalClosed")),this.removeAttribute("open"),removeTrapFocus(this.openedBy),window.pauseAllMedia()}connectedCallback(){let i=this.querySelector("[data-modal-slider]"),e=e=>{var t=!this.contains(e.target),e=i.contains(e.target);this.openedBy&&(!t||e)||this.hide()};document.addEventListener("click",e),document.body.addEventListener("modalClosed",()=>{document.removeEventListener("click",e)})}showActiveMedia(e="videos"){if("videos"!==e){var i=this.openedBy.getAttribute("data-media-id");let t=this.querySelector(`[data-media-id="${i}"]`);t?.loadContent(),t.parentElement.classList.add("swiper-slide"),t.parentElement.classList.remove("hidden"),this.querySelectorAll("[data-media-id]").forEach(e=>{e!==t&&(e.parentElement.classList.remove("swiper-slide"),e.parentElement.classList.add("hidden"))}),void this.sliderInstance.update()}else this.querySelectorAll("[data-media-id]").forEach(e=>{"product-model"===e.tagName.toLowerCase()?(e.parentElement.classList.remove("swiper-slide"),e.parentElement.classList.add("hidden")):(e.parentElement.classList.add("swiper-slide"),e.parentElement.classList.remove("hidden"))}),this.querySelector("[data-media-id]:not(.hidden [data-media-id])").loadContent()}hide(){super.hide(),pauseAllMedia();var e=this.querySelector(".swiper-slide-active product-model");e&&(e.removeAttribute("loaded"),e.querySelector(".shopify-model-viewer-ui")?.remove())}playActiveSlideVideo(e){pauseAllMedia(),e.slides.filter(e=>e.classList.contains("swiper-slide-active"))[0].querySelector("deferred-media").loadContent()}}customElements.define("product-modal",ProductModal);