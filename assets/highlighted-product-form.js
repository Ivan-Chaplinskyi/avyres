(()=>{if(!customElements.get("product-form")){class t extends HTMLElement{constructor(){super(),this.form=this.querySelector("form"),this.submitButton=this.form.querySelector('[name="add"]'),this.cartDrawer=document.querySelector("cart-drawer"),this.productBar=document.querySelector("#ProductBar-"+this.dataset.sectionId),this.form.addEventListener("submit",this.onSubmitHandler.bind(this))}onSubmitHandler(t){var e,r;t.preventDefault(),!(t=document.querySelector("purchase-options"))||t.isOneTimePurchase()||this.hasAttribute("data-has-selling-plan")?(this.submitButton.classList.add("disabled"),(e=fetchConfig("javascript")).headers["X-Requested-With"]="XMLHttpRequest",delete e.headers["Content-Type"],(r=new FormData(this.form)).append("sections",this.cartDrawer.getSectionsToRender().map(t=>t.section)),r.append("sections_url",window.location.pathname),e.body=r,fetch(""+routes.cart_add_url,e).then(t=>t.json()).then(t=>{var e;t.status?this.handleErrorMessage(t.message):(this.cartDrawer.renderContents(t),(t=document.querySelector(".cart-drawer__title-counter"))&&(e=t.innerHTML,e=parseInt(e)+1,t.innerHTML=e))}).catch(t=>{console.error(t)}).finally(()=>{this.submitButton.classList.remove("disabled")})):t.showError()}handleErrorMessage(t=!1){let e=this.querySelector("[data-error-wrapper]");e&&(e.classList.toggle("hidden",!t),e.textContent=t||"",setTimeout(()=>{e.classList.add("hidden")},5e3))}toggleAddButton(t,e){[this.submitButton,this.productBar?.querySelector('[name="add"]')].forEach(r=>{t?(r?.setAttribute("disabled","disabled"),e&&r&&(r.textContent=e)):r&&(r.removeAttribute("disabled"),r.textContent=this.hasAttribute("data-has-selling-plan")?window.variantStrings.addSubscriptionToCart:window.variantStrings.addToCart)})}}customElements.define("product-form",t)}})();